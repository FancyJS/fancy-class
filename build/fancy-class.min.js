var Fancy={version:"0.2.1",global:window};Fancy.apply=function(a,b){for(var c in b)a[c]=b[c]},Fancy.applyIf=function(a,b){for(var c in b)void 0===a[c]&&(a[c]=b[c])},Fancy.namespace=function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a],d=c.split("."),e=1,f=d.length;Fancy.global[d[0]]=Fancy.global[d[0]]||{};for(var g=Fancy.global[d[0]];f>e;e++)g[d[e]]=g[d[e]]||{},g=g[d[e]]}},Fancy.ns=Fancy.namespace,Fancy.typeOf=function(a){if(null===a)return"null";var b=typeof a;if("undefined"===b||"string"===b||"number"===b||"boolean"===b)return b;var c=Object.prototype.toString,d=c.call(a);switch(d){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===b?"function":"object"===b?"object":void 0},Fancy.isArray="isArray"in Array?Array.isArray:function(a){var b=Object.prototype.toString;return"[object Array]"===b.call(a)},Fancy.isObject=function(a){var b=Object.prototype.toString;return"[object Object]"===b.call(a)},Fancy.isFunction=function(a){var b=Object.prototype.toString;return"[object Function]"===b.apply(a)},Fancy.isString=function(a){return"string"==typeof a},Fancy.isNumber=function(a){return"number"==typeof a&&isFinite(a)},Fancy.isBoolean=function(a){return"boolean"==typeof a},Fancy.each=function(a,b){var c=a,d=Fancy.typeOf(a);switch(d){case"array":for(var e=0,f=c.length;f>e;e++)b(a[e],e,a);break;case"object":var g;for(g in a)b(a[g],g,a)}},Fancy.applyConfig=function(a,b){var c,b=b||{};if(a._isConfigApplied===!0)return a;for(c in b)a[c]=b[c];return a._isConfigApplied=!0,a},Fancy.Collection=function(a){var b=this;if(b.items=[],b.keys=[],b.map={},b.indexMap={},b.length=0,a)if(a.length>0)for(var c=0,d=a.length;d>c;c++)b.add(c,a[c]);else for(var e in a)b.add(e,a[e])},Fancy.Collection.prototype={add:function(a,b){var c=this;c.items.push(b),c.keys.push(a),c.map[a]=b,c.indexMap[a]=c.length,c.length++},remove:function(a){var b=this,c=b.indexMap[a];b.items.splice(c,1),b.keys.splice(c,1),delete b.indexMap[c],delete b.map[a],b.length--},removeAll:function(){var a=this;a.items=[],a.keys=[],a.indexMap={},a.map={},a.length=0},get:function(a){var b=this;return b.map[a]},each:function(a){for(var b=this,c=0,d=b.length;d>c;c++)a(b.keys[c],b.items[c],c,b.length)}},function(){var a={},b={},c=function(a,b){for(var c in b.prototype)void 0===a.prototype[c]&&(a.prototype[c]=b.prototype[c])},d=function(){};d.prototype={items:new Fancy.Collection,add:function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];e>d;d++)f=f[c[d]];c.length>1?f[c[c.length-1]]=b:Fancy.global[c[0]]=b,this.items.add(a,b)},get:function(a){return this.items.get(a)}},Fancy.ClassManager=new d,Fancy.Class=function(d,e){var e=e||{},f=[];if(Fancy.isArray(d)&&(f=d,d=f[0]),e.constructor===Object&&(void 0===e.extend?e.constructor=function(){}:e.constructor=function(){this.Super("constructor",arguments)}),void 0===e.extend)a[d]=e.constructor;else{a[d]=e.constructor;var g;switch(typeof e.extend){case"string":g=Fancy.ClassManager.get(e.extend),a[d].prototype.$Super=Fancy.ClassManager.get(e.extend);break;case"function":g=e.extend,a[d].prototype.$Super=e.extend}delete e.extend,a[d].prototype.Super=function(a,b){var c=this;switch(c.$Iam?c.$Iam=Fancy.ClassManager.get(c.$Iam.prototype.$Super.prototype.$name):c.$Iam=Fancy.ClassManager.get(c.$Super.prototype.$name),a){case"const":case"constructor":c.$Iam.apply(c,b);break;default:c.$Iam.prototype[a].apply(c,b)}delete c.$Iam},c(a[d],g)}a[d].prototype.$name=d,e.traits&&(Fancy.trait(a[d].prototype,e.traits),delete a[d].prototype.traits),void 0!==e.plugins&&(void 0===a[d].prototype.$plugins&&(a[d].prototype.$plugins=[]),a[d].prototype.$plugins=a[d].prototype.$plugins.concat(e.plugins),delete a[d].prototype.plugins);for(var h in e)a[d].prototype[h]=e[h];var i=a[d];e.singleton===!0&&(delete a[d],i=new i(e),a[d]=i),f.length>1?Fancy.each(f,function(a){Fancy.ClassManager.add(a,i)}):Fancy.ClassManager.add(d,i),e.type?(b[e.type]=i,Fancy.addWidgetType(e.type,i)):e.ptype&&(b[e.type]=i,Fancy.addPluginByType(e.ptype,i))}}(),function(){var a=0,b={};Fancy.Class(["Fancy.Event","Fancy.Observable"],{constructor:function(a){var b=this,a=a||{};if(Fancy.applyConfig(b,a),b.$events={},b.listeners||b.events)for(var c=b.listeners||b.events,d=0,e=c.length;e>d;d++){var f=c[d],g=null,h=null,i=null,j=[];for(var k in f)"scope"===k?i=f[k]:"params"===k?j=f[k]:(g=k,h=f[k]);if(null===g||Fancy.isFunction(h)===!1)throw new Error("Event was not set");if(Fancy.isArray(j)===!1)throw new Error("params must be array");b.addEvent(g),b.on(g,h,i,j)}},on:function(c,d,e,f){if(void 0===this.$events[c])throw console.log(arguments),new Error("Event name is not set: "+c);d.$mtFnSeed=a,b[a]=d,a++,this.$events[c].push({fn:d,scope:e,params:f||[]})},un:function(a,b){var c=this,d=c.$events[a];if(!d)return!1;for(var e=0,f=d.length;f>e;e++){var g=d[e];if(g.fn.$mtFnSeed===b.$mtFnSeed)return g.toRemove=!0,!0}return!1},once:function(a,b,c){var d=this,e=function(){b.apply(this,arguments),d.un(a,e)};d.on(a,e,c)},unAll:function(){this.$events={}},unAllByType:function(a){this.$events[a]=[]},fire:function(a){var b=this,c=b.$events[a];if(!c)return!1;for(var d=1,e=arguments.length,f=[b];e>d;d++)f.push(arguments[d]);for(var d=0,e=c.length;e>d;d++){var g=c[d],h=[];g.toRemove!==!0?(h=h.concat(f),g.params&&(h=h.concat(g.params)),g.fn.apply(g.scope||b,h)):(c.splice(d,1),d--,e=c.length)}},addEvent:function(a){var b=this;b.$events[a]=b.$events[a]||[]},addEvents:function(a){var b=this;if(arguments.length>1){for(var c=[],d=0,e=arguments.length;e>d;d++)c[d]=arguments[d];a=c}if("string"===Fancy.typeOf(a))b.$events[a]=b.$events[a]||[];else if("array"===Fancy.typeOf(a))for(var d=0,e=a.length;e>d;d++)b.$events[a[d]]=b.$events[a[d]]||[]},has:function(a){var b=this.$events[a];return b?0!==b.length:!1}})}();